language: python

python:
  - "3.6"

sudo: true

services:
  - docker

before_install:
  - rm -rf page
  - mkdir -p page

script:
  - cd docker
  - docker build -t openeo_udf .
  - docker run --name "openeo-udf-server" -p 5000:5000 -p 80:80 -t openeo_udf
  - cd ..
  - "docker cp openeo-udf-server:/var/www/html/. page/"
  
deploy:
  provider: pages
  skip-cleanup: false
  github-token: $GITHUB_TOKEN
  local-dir: page
  committer-from-gh: true
  keep-history: false
  on:
    branch: master
