language: python
python:
  - "3.6"

sudo: required

services:
  - docker

before_install:
  - sudo apt-get update -qq
  - sudo apt-get install -qq     build-essential \
    flex \
    make \
    bison \
    gcc \
    libgcc1 \
    g++ \
    python3 \
    python3-dev \
    python3-pip \
    libpython3-all-dev \
    libgsl0-dev \
    libncurses5-dev \
    zlib1g-dev \
    gettext \
    libtiff-dev \
    libpnglite-dev \
    libcairo2 \
    libcairo2-dev \
    sqlite3 \
    libpq-dev \
    proj-data \
    gdal-bin \
    libgdal-dev \
    libspatialite7 \
    moreutils \
    iotop \
    atop \
    htop \
    iperf \
    attr \
    git \
    vim \
    curl \
    wget \
    unzip \
    zip 
    #  - cd docker
    #  - docker build -t openeo_udf .
    #  - cd -

install:
  - pip3 install -r requirements.txt
  - python3 setup.py test
  - python3 setup.py install
  - python3 tests/test_doctests.py
#  - docker run --name "openeo-udf-server" -t openeo_udf
#  - mkdir page
#  - "docker cp openeo-udf-server:/var/www/html/. ../page/"
  
deploy:
  provider: pages
  github-token: $GITHUB_TOKEN
  local-dir: docker/page
  committer-from-gh: true
  keep-history: false
  on:
    branch: master
