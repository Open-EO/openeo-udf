
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="Python">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>openeo_udf.api.udf_data &#8212; openeo-udf 1.0.0rc1.post0.dev2+g7db6d90 documentation</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">openeo-udf 1.0.0rc1.post0.dev2+g7db6d90 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for openeo_udf.api.udf_data</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;OpenEO Python UDF interface&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">xarray</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span>
<span class="kn">from</span> <span class="nn">openeo_udf.api.feature_collection</span> <span class="kn">import</span> <span class="n">FeatureCollection</span>
<span class="kn">from</span> <span class="nn">openeo_udf.api.datacube</span> <span class="kn">import</span> <span class="n">DataCube</span>
<span class="kn">from</span> <span class="nn">openeo_udf.api.machine_learn_model</span> <span class="kn">import</span> <span class="n">MachineLearnModelConfig</span>
<span class="kn">from</span> <span class="nn">openeo_udf.api.spatial_extent</span> <span class="kn">import</span> <span class="n">SpatialExtent</span>
<span class="kn">from</span> <span class="nn">openeo_udf.api.structured_data</span> <span class="kn">import</span> <span class="n">StructuredData</span>
<span class="kn">from</span> <span class="nn">openeo_udf.server.data_model.metadata_schema</span> <span class="kn">import</span> <span class="n">MetadataModel</span>
<span class="kn">from</span> <span class="nn">openeo_udf.server.data_model.udf_schemas</span> <span class="kn">import</span> <span class="n">UdfDataModel</span>

<span class="n">__license__</span> <span class="o">=</span> <span class="s2">&quot;Apache License, Version 2.0&quot;</span>
<span class="n">__author__</span>     <span class="o">=</span> <span class="s2">&quot;Soeren Gebbert&quot;</span>
<span class="n">__copyright__</span>  <span class="o">=</span> <span class="s2">&quot;Copyright 2018, Soeren Gebbert&quot;</span>
<span class="n">__maintainer__</span> <span class="o">=</span> <span class="s2">&quot;Soeren Gebbert&quot;</span>
<span class="n">__email__</span>      <span class="o">=</span> <span class="s2">&quot;soerengebbert@googlemail.com&quot;</span>


<div class="viewcode-block" id="UdfData"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData">[docs]</a><span class="k">class</span> <span class="nc">UdfData</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;The class that stores the arguments for a user defined function (UDF)</span>

<span class="sd">    Some basic tests:</span>

<span class="sd">    &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">    &gt;&gt;&gt; import geopandas</span>
<span class="sd">    &gt;&gt;&gt; import numpy, pandas</span>
<span class="sd">    &gt;&gt;&gt; from sklearn.ensemble import RandomForestRegressor</span>
<span class="sd">    &gt;&gt;&gt; from sklearn.externals import joblib</span>
<span class="sd">    &gt;&gt;&gt; data = numpy.zeros(shape=(1,1,1))</span>
<span class="sd">    &gt;&gt;&gt; extent = SpatialExtent(top=100, bottom=0, right=100, left=0, height=10, width=10)</span>
<span class="sd">    &gt;&gt;&gt; starts = pandas.DatetimeIndex([pandas.Timestamp(&#39;2012-05-01&#39;)])</span>
<span class="sd">    &gt;&gt;&gt; ends = pandas.DatetimeIndex([pandas.Timestamp(&#39;2012-05-02&#39;)])</span>
<span class="sd">    &gt;&gt;&gt; p1 = Point(0,0)</span>
<span class="sd">    &gt;&gt;&gt; p2 = Point(100,100)</span>
<span class="sd">    &gt;&gt;&gt; p3 = Point(100,0)</span>
<span class="sd">    &gt;&gt;&gt; pseries = [p1, p2, p3]</span>
<span class="sd">    &gt;&gt;&gt; data = geopandas.GeoDataFrame(geometry=pseries, columns=[&quot;a&quot;, &quot;b&quot;])</span>
<span class="sd">    &gt;&gt;&gt; data[&quot;a&quot;] = [1,2,3]</span>
<span class="sd">    &gt;&gt;&gt; data[&quot;b&quot;] = [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;]</span>
<span class="sd">    &gt;&gt;&gt; C = FeatureCollection(id=&quot;C&quot;, data=data)</span>
<span class="sd">    &gt;&gt;&gt; D = FeatureCollection(id=&quot;D&quot;, data=data)</span>
<span class="sd">    &gt;&gt;&gt; udf_data = UdfData(proj={&quot;EPSG&quot;:4326}, feature_collection_list=[C, D])</span>
<span class="sd">    &gt;&gt;&gt; model = RandomForestRegressor(n_estimators=10, max_depth=2, verbose=0)</span>
<span class="sd">    &gt;&gt;&gt; path = &#39;/tmp/test.pkl.xz&#39;</span>
<span class="sd">    &gt;&gt;&gt; dummy = joblib.dump(value=model, filename=path, compress=(&quot;xz&quot;, 3))</span>
<span class="sd">    &gt;&gt;&gt; m = MachineLearnModelConfig(framework=&quot;sklearn&quot;, name=&quot;test&quot;,</span>
<span class="sd">    ...                       description=&quot;Machine learn model&quot;, path=path)</span>
<span class="sd">    &gt;&gt;&gt; udf_data.append_machine_learn_model(m)</span>
<span class="sd">    &gt;&gt;&gt; print(udf_data.get_feature_collection_by_id(&quot;C&quot;))</span>
<span class="sd">    id: C</span>
<span class="sd">    start_times: None</span>
<span class="sd">    end_times: None</span>
<span class="sd">    data:    a  b         geometry</span>
<span class="sd">    0  1  a      POINT (0 0)</span>
<span class="sd">    1  2  b  POINT (100 100)</span>
<span class="sd">    2  3  c    POINT (100 0)</span>
<span class="sd">    &gt;&gt;&gt; print(udf_data.get_feature_collection_by_id(&quot;D&quot;))</span>
<span class="sd">    id: D</span>
<span class="sd">    start_times: None</span>
<span class="sd">    end_times: None</span>
<span class="sd">    data:    a  b         geometry</span>
<span class="sd">    0  1  a      POINT (0 0)</span>
<span class="sd">    1  2  b  POINT (100 100)</span>
<span class="sd">    2  3  c    POINT (100 0)</span>
<span class="sd">    &gt;&gt;&gt; print(len(udf_data.get_feature_collection_list()) == 2)</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; print(udf_data.ml_model_list[0].path)</span>
<span class="sd">    /tmp/test.pkl.xz</span>
<span class="sd">    &gt;&gt;&gt; print(udf_data.ml_model_list[0].framework)</span>
<span class="sd">    sklearn</span>

<span class="sd">    &gt;&gt;&gt; import json</span>
<span class="sd">    &gt;&gt;&gt; json.dumps(udf_data.to_dict()) # doctest: +ELLIPSIS</span>
<span class="sd">    ...                                # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">    &#39;{&quot;proj&quot;: {&quot;EPSG&quot;: 4326}, &quot;user_context&quot;: {}, &quot;server_context&quot;: {}, &quot;datacubes&quot;: [], &quot;feature_collection_list&quot;: [{&quot;id&quot;: &quot;C&quot;, &quot;data&quot;: {&quot;type&quot;: &quot;FeatureCollection&quot;, &quot;features&quot;: [{&quot;id&quot;: &quot;0&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {&quot;a&quot;: 1, &quot;b&quot;: &quot;a&quot;}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [0.0, 0.0]}}, {&quot;id&quot;: &quot;1&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {&quot;a&quot;: 2, &quot;b&quot;: &quot;b&quot;}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [100.0, 100.0]}}, {&quot;id&quot;: &quot;2&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {&quot;a&quot;: 3, &quot;b&quot;: &quot;c&quot;}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [100.0, 0.0]}}]}}, {&quot;id&quot;: &quot;D&quot;, &quot;data&quot;: {&quot;type&quot;: &quot;FeatureCollection&quot;, &quot;features&quot;: [{&quot;id&quot;: &quot;0&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {&quot;a&quot;: 1, &quot;b&quot;: &quot;a&quot;}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [0.0, 0.0]}}, {&quot;id&quot;: &quot;1&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {&quot;a&quot;: 2, &quot;b&quot;: &quot;b&quot;}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [100.0, 100.0]}}, {&quot;id&quot;: &quot;2&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {&quot;a&quot;: 3, &quot;b&quot;: &quot;c&quot;}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [100.0, 0.0]}}]}}], &quot;structured_data_list&quot;: [], &quot;machine_learn_models&quot;: [{&quot;description&quot;: &quot;Machine learn model&quot;, &quot;name&quot;: &quot;test&quot;, &quot;framework&quot;: &quot;sklearn&quot;, &quot;path&quot;: &quot;/tmp/test.pkl.xz&quot;, &quot;md5_hash&quot;: null}]}&#39;</span>

<span class="sd">    &gt;&gt;&gt; udf = UdfData.from_dict(udf_data.to_dict())</span>
<span class="sd">    &gt;&gt;&gt; json.dumps(udf.to_dict()) # doctest: +ELLIPSIS</span>
<span class="sd">    ...                           # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">    &#39;{&quot;proj&quot;: {&quot;EPSG&quot;: 4326}, &quot;user_context&quot;: {}, &quot;server_context&quot;: {}, &quot;datacubes&quot;: [], &quot;feature_collection_list&quot;: [{&quot;id&quot;: &quot;C&quot;, &quot;data&quot;: {&quot;type&quot;: &quot;FeatureCollection&quot;, &quot;features&quot;: [{&quot;id&quot;: &quot;0&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {&quot;a&quot;: 1, &quot;b&quot;: &quot;a&quot;}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [0.0, 0.0]}}, {&quot;id&quot;: &quot;1&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {&quot;a&quot;: 2, &quot;b&quot;: &quot;b&quot;}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [100.0, 100.0]}}, {&quot;id&quot;: &quot;2&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {&quot;a&quot;: 3, &quot;b&quot;: &quot;c&quot;}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [100.0, 0.0]}}]}}, {&quot;id&quot;: &quot;D&quot;, &quot;data&quot;: {&quot;type&quot;: &quot;FeatureCollection&quot;, &quot;features&quot;: [{&quot;id&quot;: &quot;0&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {&quot;a&quot;: 1, &quot;b&quot;: &quot;a&quot;}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [0.0, 0.0]}}, {&quot;id&quot;: &quot;1&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {&quot;a&quot;: 2, &quot;b&quot;: &quot;b&quot;}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [100.0, 100.0]}}, {&quot;id&quot;: &quot;2&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {&quot;a&quot;: 3, &quot;b&quot;: &quot;c&quot;}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [100.0, 0.0]}}]}}], &quot;structured_data_list&quot;: [], &quot;machine_learn_models&quot;: [{&quot;description&quot;: &quot;Machine learn model&quot;, &quot;name&quot;: &quot;test&quot;, &quot;framework&quot;: &quot;sklearn&quot;, &quot;path&quot;: &quot;/tmp/test.pkl.xz&quot;, &quot;md5_hash&quot;: null}]}&#39;</span>

<span class="sd">    &gt;&gt;&gt; sd_list = StructuredData(description=&quot;Data list&quot;, data={&quot;list&quot;:[1,2,3]}, type=&quot;list&quot;)</span>
<span class="sd">    &gt;&gt;&gt; sd_dict = StructuredData(description=&quot;Data dict&quot;, data={&quot;A&quot;:{&quot;B&quot;: 1}}, type=&quot;dict&quot;)</span>
<span class="sd">    &gt;&gt;&gt; udf = UdfData(proj={&quot;EPSG&quot;:4326}, structured_data_list=[sd_list, sd_dict])</span>
<span class="sd">    &gt;&gt;&gt; json.dumps(udf.to_dict()) # doctest: +ELLIPSIS</span>
<span class="sd">    ...                           # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">    &#39;{&quot;proj&quot;: {&quot;EPSG&quot;: 4326}, &quot;user_context&quot;: {}, &quot;server_context&quot;: {}, &quot;datacubes&quot;: [], &quot;feature_collection_list&quot;: [], &quot;structured_data_list&quot;: [{&quot;description&quot;: &quot;Data list&quot;, &quot;data&quot;: {&quot;list&quot;: [1, 2, 3]}, &quot;type&quot;: &quot;list&quot;}, {&quot;description&quot;: &quot;Data dict&quot;, &quot;data&quot;: {&quot;A&quot;: {&quot;B&quot;: 1}}, &quot;type&quot;: &quot;dict&quot;}], &quot;machine_learn_models&quot;: []}&#39;</span>

<span class="sd">    &gt;&gt;&gt; array = xarray.DataArray(numpy.zeros(shape=(2, 3)), coords={&#39;x&#39;: [1, 2], &#39;y&#39;: [1, 2, 3]}, dims=(&#39;x&#39;, &#39;y&#39;))</span>
<span class="sd">    &gt;&gt;&gt; array.attrs[&quot;description&quot;] = &quot;This is an xarray with two dimensions&quot;</span>
<span class="sd">    &gt;&gt;&gt; array.name = &quot;testdata&quot;</span>
<span class="sd">    &gt;&gt;&gt; h = DataCube(array=array)</span>
<span class="sd">    &gt;&gt;&gt; udf_data = UdfData(proj={&quot;EPSG&quot;:4326}, datacube_list=[h])</span>
<span class="sd">    &gt;&gt;&gt; udf_data.user_context = {&quot;kernel&quot;: 3}</span>
<span class="sd">    &gt;&gt;&gt; udf_data.server_context = {&quot;reduction_dimension&quot;: &quot;t&quot;}</span>
<span class="sd">    &gt;&gt;&gt; udf_data.user_context</span>
<span class="sd">    {&#39;kernel&#39;: 3}</span>
<span class="sd">    &gt;&gt;&gt; udf_data.server_context</span>
<span class="sd">    {&#39;reduction_dimension&#39;: &#39;t&#39;}</span>
<span class="sd">    &gt;&gt;&gt; print(udf_data.get_datacube_by_id(&quot;testdata&quot;).to_dict())</span>
<span class="sd">    {&#39;id&#39;: &#39;testdata&#39;, &#39;data&#39;: [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], &#39;dimensions&#39;: [{&#39;name&#39;: &#39;x&#39;, &#39;coordinates&#39;: [1, 2]}, {&#39;name&#39;: &#39;y&#39;, &#39;coordinates&#39;: [1, 2, 3]}], &#39;description&#39;: &#39;This is an xarray with two dimensions&#39;}</span>
<span class="sd">    &gt;&gt;&gt; json.dumps(udf_data.to_dict()) # doctest: +ELLIPSIS</span>
<span class="sd">    ...                           # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">    &#39;{&quot;proj&quot;: {&quot;EPSG&quot;: 4326}, &quot;user_context&quot;: {&quot;kernel&quot;: 3}, &quot;server_context&quot;: {&quot;reduction_dimension&quot;: &quot;t&quot;}, &quot;datacubes&quot;: [{&quot;id&quot;: &quot;testdata&quot;, &quot;data&quot;: [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], &quot;dimensions&quot;: [{&quot;name&quot;: &quot;x&quot;, &quot;coordinates&quot;: [1, 2]}, {&quot;name&quot;: &quot;y&quot;, &quot;coordinates&quot;: [1, 2, 3]}], &quot;description&quot;: &quot;This is an xarray with two dimensions&quot;}], &quot;feature_collection_list&quot;: [], &quot;structured_data_list&quot;: [], &quot;machine_learn_models&quot;: []}&#39;</span>

<span class="sd">    &gt;&gt;&gt; udf = UdfData.from_dict(udf_data.to_dict())</span>
<span class="sd">    &gt;&gt;&gt; json.dumps(udf.to_dict()) # doctest: +ELLIPSIS</span>
<span class="sd">    ...                           # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">    &#39;{&quot;proj&quot;: {&quot;EPSG&quot;: 4326}, &quot;user_context&quot;: {}, &quot;server_context&quot;: {}, &quot;datacubes&quot;: [{&quot;id&quot;: &quot;testdata&quot;, &quot;data&quot;: [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], &quot;dimensions&quot;: [{&quot;name&quot;: &quot;x&quot;, &quot;coordinates&quot;: [1, 2]}, {&quot;name&quot;: &quot;y&quot;, &quot;coordinates&quot;: [1, 2, 3]}], &quot;description&quot;: &quot;This is an xarray with two dimensions&quot;}], &quot;feature_collection_list&quot;: [], &quot;structured_data_list&quot;: [], &quot;machine_learn_models&quot;: []}&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">datacube_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">DataCube</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">feature_collection_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">FeatureCollection</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">structured_data_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">StructuredData</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">ml_model_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">MachineLearnModelConfig</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">metadata</span><span class="p">:</span> <span class="n">MetadataModel</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The constructor of the UDF argument class that stores all data required by the</span>
<span class="sd">        user defined function.</span>

<span class="sd">        Args:</span>
<span class="sd">            proj (dict): A dictionary of form {&quot;proj type string&quot;: &quot;projection decription&quot;} i. e. {&quot;EPSG&quot;:4326}</span>
<span class="sd">            datacube_list (list(HyperCube)): A list of HyperCube objects</span>
<span class="sd">            feature_collection_list (list[FeatureCollection]): A list of VectorTile objects</span>
<span class="sd">            structured_data_list (list[StructuredData]): A list of structured data objects</span>
<span class="sd">            ml_model_list (list[MachineLearnModelConfig]): A list of machine learn models</span>
<span class="sd">            metadata (MetadataModel): additional metadata</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_datacube_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feature_tile_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datacube_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feature_tile_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_structured_data_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ml_model_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proj</span> <span class="o">=</span> <span class="n">proj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">:</span> <span class="n">MetadataModel</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_user_context</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_server_context</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">datacube_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_datacube_list</span><span class="p">(</span><span class="n">datacube_list</span><span class="o">=</span><span class="n">datacube_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">feature_collection_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_feature_collection_list</span><span class="p">(</span><span class="n">feature_collection_list</span><span class="o">=</span><span class="n">feature_collection_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">structured_data_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_structured_data_list</span><span class="p">(</span><span class="n">structured_data_list</span><span class="o">=</span><span class="n">structured_data_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ml_model_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_ml_model_list</span><span class="p">(</span><span class="n">ml_model_list</span><span class="o">=</span><span class="n">ml_model_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">metadata</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MetadataModel</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span>

    <span class="nd">@metadata</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">MetadataModel</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">model</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">user_context</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the user context that was passed to the run_udf function&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_user_context</span>

    <span class="nd">@user_context</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">user_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the user context&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_user_context</span> <span class="o">=</span> <span class="n">context</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">server_context</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the server context that is passed from the backend to the UDF server for runtime configuration&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_context</span>

    <span class="nd">@server_context</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">server_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the server context&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_server_context</span> <span class="o">=</span> <span class="n">context</span>

<div class="viewcode-block" id="UdfData.get_datacube_by_id"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.get_datacube_by_id">[docs]</a>    <span class="k">def</span> <span class="nf">get_datacube_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataCube</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get a datacube by its id</span>

<span class="sd">        Args:</span>
<span class="sd">            id (str): The datacube id</span>

<span class="sd">        Returns:</span>
<span class="sd">            HypeCube: the requested datacube or None if not found</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datacube_dict</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datacube_dict</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="UdfData.get_feature_collection_by_id"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.get_feature_collection_by_id">[docs]</a>    <span class="k">def</span> <span class="nf">get_feature_collection_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FeatureCollection</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get a feature collection by its id</span>

<span class="sd">        Args:</span>
<span class="sd">            id (str): The vector tile id</span>

<span class="sd">        Returns:</span>
<span class="sd">            FeatureCollection: the requested feature collection or None if not found</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_feature_tile_dict</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_feature_tile_dict</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="UdfData.get_datacube_list"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.get_datacube_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_datacube_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">DataCube</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Get the datacube list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datacube_list</span></div>

<div class="viewcode-block" id="UdfData.set_datacube_list"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.set_datacube_list">[docs]</a>    <span class="k">def</span> <span class="nf">set_datacube_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datacube_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DataCube</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Set the datacube list</span>

<span class="sd">        If datacube_list is None, then the list will be cleared</span>

<span class="sd">        Args:</span>
<span class="sd">            datacube_list (List[DataCube]): A list of HyperCube&#39;s</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">del_datacube_list</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">datacube_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">datacube</span> <span class="ow">in</span> <span class="n">datacube_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append_datacube</span><span class="p">(</span><span class="n">datacube</span><span class="p">)</span></div>

<div class="viewcode-block" id="UdfData.del_datacube_list"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.del_datacube_list">[docs]</a>    <span class="k">def</span> <span class="nf">del_datacube_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete all datacubes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datacube_list</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datacube_dict</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

<div class="viewcode-block" id="UdfData.get_feature_collection_list"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.get_feature_collection_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_feature_collection_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">FeatureCollection</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Get all feature collections as list</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[FeatureCollection]: The list of feature collections</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_feature_tile_list</span></div>

<div class="viewcode-block" id="UdfData.set_feature_collection_list"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.set_feature_collection_list">[docs]</a>    <span class="k">def</span> <span class="nf">set_feature_collection_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature_collection_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">FeatureCollection</span><span class="p">]]):</span>
        <span class="sd">&quot;&quot;&quot;Set the feature collection tiles</span>

<span class="sd">        If feature_collection_tiles is None, then the list will be cleared</span>

<span class="sd">        Args:</span>
<span class="sd">            feature_collection_list (list[FeatureCollection]): A list of FeatureCollectionTile&#39;s</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">del_feature_collection_list</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">feature_collection_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">feature_collection_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append_feature_collection</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span></div>

<div class="viewcode-block" id="UdfData.del_feature_collection_list"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.del_feature_collection_list">[docs]</a>    <span class="k">def</span> <span class="nf">del_feature_collection_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete all feature collection tiles</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feature_tile_list</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feature_tile_dict</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

<div class="viewcode-block" id="UdfData.get_structured_data_list"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.get_structured_data_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_structured_data_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">StructuredData</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Get all structured data entries</span>

<span class="sd">        Returns:</span>
<span class="sd">            (list[StructuredData]): A list of StructuredData objects</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structured_data_list</span></div>

<div class="viewcode-block" id="UdfData.set_structured_data_list"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.set_structured_data_list">[docs]</a>    <span class="k">def</span> <span class="nf">set_structured_data_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structured_data_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">StructuredData</span><span class="p">]]):</span>
        <span class="sd">&quot;&quot;&quot;Set the list of structured data</span>

<span class="sd">        If structured_data_list is None, then the list will be cleared</span>

<span class="sd">        Args:</span>
<span class="sd">            structured_data_list (list[StructuredData]): A list of StructuredData objects</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">del_structured_data_list</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">structured_data_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">structured_data_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_structured_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span></div>

<div class="viewcode-block" id="UdfData.del_structured_data_list"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.del_structured_data_list">[docs]</a>    <span class="k">def</span> <span class="nf">del_structured_data_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete all structured data entries</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_structured_data_list</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

<div class="viewcode-block" id="UdfData.get_ml_model_list"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.get_ml_model_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_ml_model_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">MachineLearnModelConfig</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Get all machine learn models</span>

<span class="sd">        Returns:</span>
<span class="sd">            (list[MachineLearnModel]): A list of MachineLearnModel objects</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ml_model_list</span></div>

<div class="viewcode-block" id="UdfData.set_ml_model_list"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.set_ml_model_list">[docs]</a>    <span class="k">def</span> <span class="nf">set_ml_model_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ml_model_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">MachineLearnModelConfig</span><span class="p">]]):</span>
        <span class="sd">&quot;&quot;&quot;Set the list of machine learn models</span>

<span class="sd">        If ml_model_list is None, then the list will be cleared</span>

<span class="sd">        Args:</span>
<span class="sd">            ml_model_list (list[MachineLearnModelConfig]): A list of MachineLearnModel objects</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">del_ml_model_list</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ml_model_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">ml_model_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ml_model_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span></div>

<div class="viewcode-block" id="UdfData.del_ml_model_list"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.del_ml_model_list">[docs]</a>    <span class="k">def</span> <span class="nf">del_ml_model_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete all machine learn models</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ml_model_list</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

    <span class="n">datacube_list</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">get_datacube_list</span><span class="p">,</span>
                             <span class="n">fset</span><span class="o">=</span><span class="n">set_datacube_list</span><span class="p">,</span> <span class="n">fdel</span><span class="o">=</span><span class="n">del_datacube_list</span><span class="p">)</span>
    <span class="n">feature_collection_list</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">get_feature_collection_list</span><span class="p">,</span>
                                       <span class="n">fset</span><span class="o">=</span><span class="n">set_feature_collection_list</span><span class="p">,</span> <span class="n">fdel</span><span class="o">=</span><span class="n">del_feature_collection_list</span><span class="p">)</span>
    <span class="n">structured_data_list</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">get_structured_data_list</span><span class="p">,</span>
                                    <span class="n">fset</span><span class="o">=</span><span class="n">set_structured_data_list</span><span class="p">,</span> <span class="n">fdel</span><span class="o">=</span><span class="n">del_structured_data_list</span><span class="p">)</span>
    <span class="n">ml_model_list</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">get_ml_model_list</span><span class="p">,</span>
                                  <span class="n">fset</span><span class="o">=</span><span class="n">set_ml_model_list</span><span class="p">,</span> <span class="n">fdel</span><span class="o">=</span><span class="n">del_ml_model_list</span><span class="p">)</span>


<div class="viewcode-block" id="UdfData.append_datacube"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.append_datacube">[docs]</a>    <span class="k">def</span> <span class="nf">append_datacube</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datacube</span><span class="p">:</span> <span class="n">DataCube</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append a HyperCube to the list</span>

<span class="sd">        It will be automatically added to the dictionary of all datacubes</span>

<span class="sd">        Args:</span>
<span class="sd">            datacube (DataCube): The HyperCube to append</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datacube_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datacube</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_datacube_dict</span><span class="p">[</span><span class="n">datacube</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">datacube</span></div>

<div class="viewcode-block" id="UdfData.append_feature_collection"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.append_feature_collection">[docs]</a>    <span class="k">def</span> <span class="nf">append_feature_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feature_collection_tile</span><span class="p">:</span> <span class="n">FeatureCollection</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append a feature collection tile to the list</span>

<span class="sd">        It will be automatically added to the dictionary of all feature collection tiles</span>

<span class="sd">        Args:</span>
<span class="sd">            feature_collection_tile (FeatureCollection): The feature collection tile to append</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feature_tile_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature_collection_tile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_feature_tile_dict</span><span class="p">[</span><span class="n">feature_collection_tile</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">feature_collection_tile</span></div>

<div class="viewcode-block" id="UdfData.append_structured_data"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.append_structured_data">[docs]</a>    <span class="k">def</span> <span class="nf">append_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structured_data</span><span class="p">:</span> <span class="n">StructuredData</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append a structured data object to the list</span>

<span class="sd">        Args:</span>
<span class="sd">            structured_data (StructuredData): A StructuredData objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_structured_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">structured_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="UdfData.append_machine_learn_model"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.append_machine_learn_model">[docs]</a>    <span class="k">def</span> <span class="nf">append_machine_learn_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">machine_learn_model</span><span class="p">:</span> <span class="n">MachineLearnModelConfig</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append a machine learn model to the list</span>

<span class="sd">        Args:</span>
<span class="sd">            machine_learn_model (MachineLearnModelConfig): A MachineLearnModel objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ml_model_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">machine_learn_model</span><span class="p">)</span></div>

<div class="viewcode-block" id="UdfData.to_dict"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Convert this UdfData object into a dictionary that can be converted into</span>
<span class="sd">        a valid JSON representation</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict:</span>
<span class="sd">            UdfData object as a dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;proj&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj</span><span class="p">,</span> <span class="s2">&quot;user_context&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_context</span><span class="p">,</span> <span class="s2">&quot;server_context&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">server_context</span><span class="p">}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datacube_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">datacube</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_datacube_list</span><span class="p">:</span>
                <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datacube</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="n">d</span><span class="p">[</span><span class="s2">&quot;datacubes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_feature_tile_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">tile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_feature_tile_list</span><span class="p">:</span>
                <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tile</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="n">d</span><span class="p">[</span><span class="s2">&quot;feature_collection_list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structured_data_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structured_data_list</span><span class="p">:</span>
                <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="n">d</span><span class="p">[</span><span class="s2">&quot;structured_data_list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ml_model_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ml_model_list</span><span class="p">:</span>
                <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="n">d</span><span class="p">[</span><span class="s2">&quot;machine_learn_models&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>

        <span class="k">return</span> <span class="n">d</span></div>

<div class="viewcode-block" id="UdfData.from_dict"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.from_dict">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="n">udf_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a udf data object from a python dictionary that was created from</span>
<span class="sd">        the JSON definition of the UdfData class</span>

<span class="sd">        Args:</span>
<span class="sd">            udf_dict (dict): The dictionary that contains the udf data definition</span>

<span class="sd">        Returns:</span>
<span class="sd">            UdfData:</span>
<span class="sd">            A new UdfData object</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s2">&quot;proj&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">udf_dict</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Missing projection in dictionary&quot;</span><span class="p">)</span>

        <span class="n">udf_data</span> <span class="o">=</span> <span class="n">UdfData</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="n">udf_dict</span><span class="p">[</span><span class="s2">&quot;proj&quot;</span><span class="p">])</span>

        <span class="k">if</span> <span class="s2">&quot;user_context&quot;</span> <span class="ow">in</span> <span class="n">udf_dict</span><span class="p">:</span>
            <span class="n">udf_data</span><span class="o">.</span><span class="n">user_context</span> <span class="o">=</span> <span class="n">udf_dict</span><span class="p">[</span><span class="s2">&quot;user_context&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="s2">&quot;server_context&quot;</span> <span class="ow">in</span> <span class="n">udf_dict</span><span class="p">:</span>
            <span class="n">udf_data</span><span class="o">.</span><span class="n">server_context</span> <span class="o">=</span> <span class="n">udf_dict</span><span class="p">[</span><span class="s2">&quot;server_context&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="s2">&quot;datacubes&quot;</span> <span class="ow">in</span> <span class="n">udf_dict</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">udf_dict</span><span class="p">[</span><span class="s2">&quot;datacubes&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
                <span class="n">h</span> <span class="o">=</span> <span class="n">DataCube</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                <span class="n">udf_data</span><span class="o">.</span><span class="n">append_datacube</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;feature_collection_list&quot;</span> <span class="ow">in</span> <span class="n">udf_dict</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">udf_dict</span><span class="p">[</span><span class="s2">&quot;feature_collection_list&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
                <span class="n">fct</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                <span class="n">udf_data</span><span class="o">.</span><span class="n">append_feature_collection</span><span class="p">(</span><span class="n">fct</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;structured_data_list&quot;</span> <span class="ow">in</span> <span class="n">udf_dict</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">udf_dict</span><span class="p">[</span><span class="s2">&quot;structured_data_list&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
                <span class="n">sd</span> <span class="o">=</span> <span class="n">StructuredData</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                <span class="n">udf_data</span><span class="o">.</span><span class="n">append_structured_data</span><span class="p">(</span><span class="n">sd</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;machine_learn_models&quot;</span> <span class="ow">in</span> <span class="n">udf_dict</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">udf_dict</span><span class="p">[</span><span class="s2">&quot;machine_learn_models&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
                <span class="n">mlm</span> <span class="o">=</span> <span class="n">MachineLearnModelConfig</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                <span class="n">udf_data</span><span class="o">.</span><span class="n">append_machine_learn_model</span><span class="p">(</span><span class="n">mlm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">udf_data</span></div>

<div class="viewcode-block" id="UdfData.from_udf_data_model"><a class="viewcode-back" href="../../../api/openeo_udf.api.html#openeo_udf.api.udf_data.UdfData.from_udf_data_model">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_udf_data_model</span><span class="p">(</span><span class="n">udf_model</span><span class="p">:</span> <span class="n">UdfDataModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;UdfData&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;TODO: Must be implemented</span>

<span class="sd">        Args:</span>
<span class="sd">            udf_model:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">udf_data</span> <span class="o">=</span> <span class="n">UdfData</span><span class="p">()</span>

        <span class="n">udf_data</span><span class="o">.</span><span class="n">server_context</span> <span class="o">=</span> <span class="n">udf_model</span><span class="o">.</span><span class="n">server_context</span>
        <span class="n">udf_data</span><span class="o">.</span><span class="n">user_context</span> <span class="o">=</span> <span class="n">udf_model</span><span class="o">.</span><span class="n">user_context</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">udf_model</span><span class="o">.</span><span class="n">structured_data_list</span><span class="p">:</span>
            <span class="n">sd</span> <span class="o">=</span> <span class="n">StructuredData</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">udf_data</span><span class="o">.</span><span class="n">append_structured_data</span><span class="p">(</span><span class="n">sd</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">udf_model</span><span class="o">.</span><span class="n">machine_learn_models</span><span class="p">:</span>
            <span class="n">mlm</span> <span class="o">=</span> <span class="n">MachineLearnModelConfig</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">dict</span><span class="p">())</span>
            <span class="n">udf_data</span><span class="o">.</span><span class="n">append_machine_learn_model</span><span class="p">(</span><span class="n">mlm</span><span class="p">)</span>
        <span class="n">cubes</span> <span class="o">=</span> <span class="n">DataCube</span><span class="o">.</span><span class="n">from_data_collection</span><span class="p">(</span><span class="n">udf_model</span><span class="o">.</span><span class="n">data_collection</span><span class="p">)</span>
        <span class="n">udf_data</span><span class="o">.</span><span class="n">set_datacube_list</span><span class="p">(</span><span class="n">cubes</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">udf_data</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">openeo-udf 1.0.0rc1.post0.dev2+g7db6d90 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Soeren Gebbert.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.2.
    </div>
  </body>
</html>